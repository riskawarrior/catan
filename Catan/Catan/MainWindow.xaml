<Window x:Class="Catan.MainWindow"
				xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
				xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
				xmlns:View="clr-namespace:Catan.View"
				xmlns:System="clr-namespace:System;assembly=mscorlib"
				xmlns:ViewModel="clr-namespace:Catan.ViewModel"
				xmlns:Converters="clr-namespace:Catan.ViewModel.Converters"
				Title="Catan - The Game"
				Height="350"
				Width="525">
	<Window.Resources>
		<Converters:PlayerColorValueConverter x:Key="playerColorConverter" />
	</Window.Resources>
	<Grid>

		<Border BorderBrush="Black"
						BorderThickness="2">
			<ItemsControl ItemsSource="{Binding GameCells}"
										ClipToBounds="True">
				<ItemsControl.ItemsPanel>
					<ItemsPanelTemplate>
						<View:GameCanvas Rows="{Binding TableSize.Width}"
														 Columns="{Binding TableSize.Height}"
														 IsItemsHost="True" />
					</ItemsPanelTemplate>
				</ItemsControl.ItemsPanel>

				<ItemsControl.ItemContainerStyle>
					<Style TargetType="ContentPresenter">
						<Style.Triggers>
							<Trigger Property="IsMouseOver"
											 Value="True">
								<Setter Property="Panel.ZIndex"
												Value="1000000" />
							</Trigger>
						</Style.Triggers>
					</Style>
				</ItemsControl.ItemContainerStyle>

				<ItemsControl.ItemTemplate>
					<DataTemplate DataType="ViewModel:GameCellContext">
						<Button DataContext="{Binding}"
										Width="80"
										Height="80"
										Command="{Binding SelectCommand}">
							<Button.Style>
								<Style TargetType="Button">
									<Setter Property="Background"
													Value="Red" />
								</Style>

							</Button.Style>
							<Button.Template>
								<ControlTemplate TargetType="Button">
									<View:GameCell Content="{Binding Value}"
																 DataContext="{TemplateBinding DataContext}"
																 Width="{TemplateBinding Width}"
																 Height="{TemplateBinding Height}">
										<View:GameCell.Style>
											<Style TargetType="View:GameCell">
												<Setter Property="Background"
																Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Background}" />
												<Style.Triggers>

													<Trigger Property="IsMouseOver"
																	 Value="True">
														<Setter Property="RenderTransform">
															<Setter.Value>
																<ScaleTransform ScaleX="1.4"
																								ScaleY="1.4"
																								CenterX="40"
																								CenterY="40" />
															</Setter.Value>
														</Setter>
													</Trigger>
												</Style.Triggers>
											</Style>
										</View:GameCell.Style>

									</View:GameCell>
								</ControlTemplate>
							</Button.Template>
						</Button>
					</DataTemplate>
				</ItemsControl.ItemTemplate>
			</ItemsControl>
		</Border>

		<Border BorderBrush="Black"
						BorderThickness="2 0 0 2"
						VerticalAlignment="Top"
						Padding="10"
						MinWidth="150"
						CornerRadius="0 0 0 10"
						HorizontalAlignment="Right">
			<Border.Background>
				<SolidColorBrush Color="{Binding CurrentPlayer.Color, Converter={StaticResource playerColorConverter}}" />
			</Border.Background>
			<StackPanel>
				<StackPanel.Resources>
					<Style TargetType="TextBlock">
						<Setter Property="FontWeight"
										Value="Bold" />
						<Setter Property="Foreground"
										Value="White" />
						<Setter Property="Margin"
										Value="0 0 0 10" />
					</Style>
				</StackPanel.Resources>
				<TextBlock Text="{Binding CurrentPlayer.Name}" />
				<TextBlock Text="Dobott érték" />
				<Button Command="{Binding StepCommand}">
					Dobás
				</Button>
			</StackPanel>
		</Border>

		<View:GameCellOptions DataContext="{Binding}">
			<View:GameCellOptions.Style>
				<Style TargetType="View:GameCellOptions">
					<Style.Triggers>
						<DataTrigger Binding="{Binding SelectedGameCell}"
												 Value="{x:Null}">
							<Setter Property="Visibility"
											Value="Hidden" />
						</DataTrigger>
					</Style.Triggers>
				</Style>
			</View:GameCellOptions.Style>
		</View:GameCellOptions>

	</Grid>
</Window>
